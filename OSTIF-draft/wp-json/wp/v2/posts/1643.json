{"id":1643,"date":"2018-10-22T12:58:21","date_gmt":"2018-10-22T12:58:21","guid":{"rendered":"https:\/\/ostif.org\/?p=1643"},"modified":"2019-06-30T23:04:41","modified_gmt":"2019-06-30T23:04:41","slug":"the-ostif-and-quarkslab-audit-of-monero-bulletproofs-is-complete-critical-bug-patched","status":"publish","type":"post","link":"https:\/\/ostif.org\/the-ostif-and-quarkslab-audit-of-monero-bulletproofs-is-complete-critical-bug-patched\/","title":{"rendered":"The OSTIF and QuarksLab Audit of Monero Bulletproofs is Complete &#8211; Critical Bug Patched"},"content":{"rendered":"<p><img decoding=\"async\" loading=\"lazy\" class=\"alignright wp-image-1835 size-medium\" src=\"https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/monero-vulnerabilities-300x300.png\" alt=\"\" width=\"300\" height=\"300\" srcset=\"https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/monero-vulnerabilities-300x300.png 300w, https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/monero-vulnerabilities-150x150.png 150w, https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/monero-vulnerabilities.png 428w\" sizes=\"(max-width: 300px) 100vw, 300px\" \/><a href=\"https:\/\/crypto.stanford.edu\/bulletproofs\/\"><span style=\"color: #289dcc;\">Bulletproofs<\/span><\/a>\u00a0are a specific type of range proof based on new cryptography by Benedikt Bunz et al. Bulletproofs are a trustless proofs setup that are substantially smaller than the current Borromean style range proofs that were previously used, which reduces the size of Monero transactions by 80-90%.<\/p>\n<p>Monero\u2019s latest network update, which is now live, has enabled Bulletproofs and corrected all outstanding issues that were raised by the Kudelski and QuarksLab projects.<\/p>\n<p><strong>QuarksLab found:<\/strong><br \/>\n8 <span style=\"color: #cc284b;\">Critical<\/span> Vulnerabilities<br \/>\n2 <span style=\"color: #cca928;\">Medium<\/span> Vulnerabilities<br \/>\n20 <span style=\"color: #28cc57;\">Low<\/span> or <span style=\"color: #28cc57;\">Informational<\/span> Vulnerabilities \/ Concerns \/ Recommendations<\/p>\n<hr \/>\n<h4><span style=\"color: #cc284b;\">One live-chain critical flaw identified and fixed:<\/span><\/h4>\n<p>QuarksLab found a denial of service vulnerability that could allow an attacker to\u00a0<strong>arbitrarily crash Monero nodes remotely<\/strong>, creating a vulnerability for a large-scale denial of service campaign for the Monero network and further potentially leading to a 51% attack and forced chain split, ultimately leading to double-spends.<\/p>\n<p>Because this flaw impacted live code, OSTIF, QuarksLab, and the Monero team agreed to a disclosure embargo on this report until after the latest network upgrade that forced users to upgrade their nodes to patched code. The Monero XMR network is now safe from this flaw.<\/p>\n<hr \/>\n<h2>Other serious bugs that were identified and fixed:<\/h2>\n<ul>\n<li><span style=\"color: #cc284b;\"><em>A lack of null value checks in the Bulletproofs proving algorithm.<\/em><\/span> The bulletproofs code relies on values being passed to it not being null, but did not proactively ensure that null values cannot be passed or checked for.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Dependent Generators in original java version of Bulletproofs are not secure.<\/em><\/span> The code had to be revised to improve number generation.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Overflow in double scalar multiplication.<\/em><\/span> The code needed to be patched to prevent the overflow of data.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Erroneous identity output in Bos-Coster multi-exponentiation.<\/em><\/span> The structure of the code could select the wrong input and return incorrect values.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Silently discarded element in Pippenger multi-exponentiation.<\/em><\/span> An optimization designed to discard large numbers of leading zeros could return the identity if a value of x^0 was entered into the function, meaning that the operation can return the identity unmodified. The optimization also had the additional issue of possibly discarding critical values for exact powers of two as inputs.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Invalid Verify input parameters.<\/em><\/span> There are no checks that the points provided are indeed points of Ed25519 and that they are on the main subgroup.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Key compromise in Schnorr signature.<\/em><\/span> In order to generate a valid Schnorr signature, the value k cannot be null or zero. If the value is null, an attacker can detect this and know the value of the key used to sign. If the value k is zero, then the value of the result is independent of the key and invalid. Checks needed to be added to the Schnorr signature to verify that the value k is not null or zero.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Failures in input size validation during (de)serialization.<\/em><\/span> A serialization error could allow an attacker to allocate up to 4GB of memory by initializing a value of 0 for nbp. Consequently, this can lead to memory being allocated for partially completed containers.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Failures in input type validation during (de)serialization.<\/em><\/span> A lack of robust checking for input type error from untrusted sources can lead to undesired behavior and error states.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Twenty other recommendations to improve security, robustness, practices, and performance.<\/em><\/span>\u00a0The team also made a number of recommendations to code practices to improve the robustness of Monero code, to optimize performance, to improve error handling, and to reduce the attack surface of the software.<\/li>\n<\/ul>\n<hr \/>\n<p>This is the second of two audits that were conducted for Monero Bulletproofs. The first audit of Bulletproofs was conducted by Kudelski Security and the results\u00a0<a href=\"https:\/\/ostif.org\/the-quarkslab-and-kudelski-security-audits-of-monero-bulletproofs-are-complete\/\">are here<\/a>.<\/p>\n<p>If you would like to review the full QuarksLab audit the direct link is below: (please do not hotlink directly to the PDF, we would like visitors to come to the OSTIF site, it helps us gain more support for the cause, thank you!)<br \/>\n<a href=\"https:\/\/ostif.org\/wp-content\/uploads\/2018\/10\/OSTIF-QuarksLab-Monero-Bulletproofs-Final2.pdf\">https:\/\/ostif.org\/wp-content\/uploads\/2018\/10\/OSTIF-QuarksLab-Monero-Bulletproofs-Final2.pdf<\/a><\/p>\n<p>We are working hard to make open source software safer and easier to use. Follow our activity both on our website and through\u00a0<a href=\"https:\/\/twitter.com\/OSTIFofficial\">our Twitter<\/a>.<\/p>\n<hr \/>\n<p>The\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/ostif.org\/\">Open Source Technology Improvement Fund<\/a><\/span>,\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/getmonero.org\/resources\/research-lab\/index.html\">Monero Research Lab<\/a><\/span>,\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/www.quarkslab.com\/en\/\">QuarksLab<\/a><\/span>, and the\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/www.reddit.com\/r\/monero\">Monero community<\/a><\/span>\u00a0have come together to sponsor in-depth research looking into Monero Bulletproofs. The audit was funded by Monero community donations, with coordination and exchange support from OSTIF. The audit was conducted by QuarksLab. We\u2019d like to thank our OSTIF sponsors\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/www.privateinternetaccess.com\/\">Private Internet Access<\/a><\/span>,\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/www.expressvpn.com\/\">ExpressVPN<\/a><\/span>, and\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/duckduckgo.com\/\">DuckDuckGo<\/a><\/span>, for making OSTIF possible and helping to make this opportunity happen.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Bulletproofs\u00a0are a specific type of range proof based on new cryptography by Benedikt Bunz et al. Bulletproofs are a trustless proofs setup that are substantially smaller than the current Borromean style range proofs that were previously used, which reduces the size of Monero transactions by 80-90%. Monero\u2019s latest network update, which is now live, has [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":1735,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[69,57,67,60],"tags":[26,3,47,35,18,27],"_links":{"self":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/1643"}],"collection":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/comments?post=1643"}],"version-history":[{"count":19,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/1643\/revisions"}],"predecessor-version":[{"id":1954,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/1643\/revisions\/1954"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/media\/1735"}],"wp:attachment":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/media?parent=1643"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/categories?post=1643"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/tags?post=1643"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}