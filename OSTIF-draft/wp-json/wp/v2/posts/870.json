{"id":870,"date":"2017-05-11T14:51:45","date_gmt":"2017-05-11T14:51:45","guid":{"rendered":"https:\/\/ostif.org\/?p=870"},"modified":"2019-09-17T23:51:46","modified_gmt":"2019-09-17T23:51:46","slug":"the-openvpn-2-4-0-audit-by-ostif-and-quarkslab-results","status":"publish","type":"post","link":"https:\/\/ostif.org\/the-openvpn-2-4-0-audit-by-ostif-and-quarkslab-results\/","title":{"rendered":"The OpenVPN 2.4.0 Audit by OSTIF and QuarksLab Results"},"content":{"rendered":"<p><img decoding=\"async\" loading=\"lazy\" class=\"wp-image-1836 size-medium alignright\" src=\"https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/openssl-vulnerabilities-300x300.png\" alt=\"\" width=\"300\" height=\"300\" srcset=\"https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/openssl-vulnerabilities-300x300.png 300w, https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/openssl-vulnerabilities-150x150.png 150w, https:\/\/ostif.org\/wp-content\/uploads\/2019\/06\/openssl-vulnerabilities.png 428w\" sizes=\"(max-width: 300px) 100vw, 300px\" \/>OpenVPN 2.4.0, the NDIS6 TAP Driver for Windows, the Windows GUI, and Linux versions were evaluated. This release included a number of new features including control channel encryption.<\/p>\n<p>QuarksLab found:<br \/>\n1\u00a0<span style=\"color: #cc284b;\">Critical\/High<\/span>\u00a0Vulnerability\u00a0<a href=\"https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2017-7478\">CVE-2017-7478<\/a><br \/>\n1\u00a0<span style=\"color: #cca928;\">Medium<\/span>\u00a0Vulnerability\u00a0<a href=\"https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2017-7479\">CVE-2017-7479<\/a><br \/>\n5\u00a0<span style=\"color: #28cc57;\">Low<\/span>\u00a0or\u00a0<span style=\"color: #28cc57;\">Informational<\/span>\u00a0Vulnerabilities \/ Concerns<\/p>\n<p>This public disclosure of these vulnerabilities coincides with the release of OpenVPN 2.4.2 which fixes all of the high priority concerns.<\/p>\n<hr \/>\n<h2><strong>The Fixes:<\/strong><\/h2>\n<p>Because of this audit, the OpenVPN development team has issued a number of fixes in OpenVPN 2.4.2.<\/p>\n<p><strong>The fixes include:<\/strong><\/p>\n<ul>\n<li><span style=\"color: #cc284b;\"><em>Correction of a pre-authentication Denial of Service attack<\/em>.<\/span> An attacker can crash any OpenVPN client or server without any credentials or keys.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Correction of an authenticated user Denial of Service attack<\/em>.<\/span> An attacker can crash an OpenVPN client or server using an AEAD mode cipher by sending crafted data to exhaust the packet counter. Requires authentication.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Correction of issues in mbedtls (PolarSSL) X509 certificate handling.<\/em><\/span>\u00a0Verify return values of mbedtls_x509_dn_gets and mbedtls_x509_serial_gets correctly.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Correction of usernames and passwords not being properly erased.<\/em><\/span>\u00a0for the new bootloader. (keystrokes not erased after authentication)<\/li>\n<li><em><span style=\"color: #cc284b;\">Correction of null pointer dereferences.<\/span>\u00a0<\/em><em>Because this issue is low-severity and not exploitable, this fix is reserved for a future release.<\/em><\/li>\n<li><span style=\"color: #cc284b;\"><em>Correction of service handling for OpenVPN GUI.<\/em><\/span>\u00a0The OpenVPN GUI did not properly terminate the service when closed.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Improvements to documentation of the OpenVPN protocol.<\/em><\/span>\u00a0Improving transparency of functionality for developers working with the OpenVPN protocol.<\/li>\n<li><span style=\"color: #cc284b;\"><em>Updates to user documentation for other vulnerabilities that can be closed by user practices<\/em>.<\/span>\u00a0Such as selecting more secure options, and deprecating antiquated options that are unsafe.<\/li>\n<\/ul>\n<p><strong>Furthermore the following was affirmed:<br \/>\n<\/strong><\/p>\n<ul>\n<li>When using OpenSSL, OpenVPN uses the<strong>\u00a0RAND_bytes\u00a0<\/strong>function for entropy exclusively. It appears to utilize it correctly with proper error handling.<\/li>\n<li>When using mbedTLS, OpenVPN uses the\u00a0<strong>mbedtls_ctr_drbg_random<\/strong>\u00a0function for entropy exclusively. It appears to utilize it correctly with proper error handling.<\/li>\n<li>When generating \u201cnon critical\u201d random values, OpenVPN uses a custom algorithm that is\u00a0<strong>non-standard but cryptographically sound<\/strong>.<\/li>\n<li>OpenVPN contains some legacy code related to end-of-life versions of OpenSSL that are no longer supported.<\/li>\n<\/ul>\n<hr \/>\n<p>The full audit report can be accessed below,\u00a0<strong>please do not direct link to the audit report, as we would like visitors to see our synopsis and donation links before viewing the full audit<\/strong>. Thank you.<\/p>\n<p><span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/ostif.org\/wp-content\/uploads\/2017\/05\/OpenVPN1.2final.pdf\">https:\/\/ostif.org\/wp-content\/uploads\/2017\/05\/OpenVPN1.2final.pdf<\/a><\/span><\/p>\n<p>There was also another security review performed by Dr Matthew Green at Cryptography Engineering paid for by Private Internet Access. You can access this security evaluation here:<\/p>\n<p><span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/privateinternetaccess.com\/blog\/2017\/05\/openvpn-2-4-evaluation-summary-and-report\/\">https:\/\/privateinternetaccess.com\/blog\/2017\/05\/openvpn-2-4-evaluation-summary-and-report\/<\/a><\/span><\/p>\n<p>Cryptography Engineering focused on the cryptography aspects of OpenVPN, and gave a list of recommended changes to improve the general cryptographic strength of OpenVPN.<\/p>\n<ul>\n<li><span style=\"color: #28cc57;\">Correction of authentication token handling in TLS auth while in an error state.<\/span>\u00a0This has a commit in the 2.4 branch and will be fixed in a future release. It is low-impact.<\/li>\n<li><span style=\"color: #28cc57;\">Potential loss of privacy with TLS auth or TLS crypt IV collision.<\/span>\u00a0The OpenVPN team is updating documentation and disagrees with the wording of a \u201ctotal loss of privacy\u201d. These functions protect already encrypted data with a second layer of encryption.<\/li>\n<li><span style=\"color: #28cc57;\">Removal of the \u2013no-IV option.<\/span>\u00a0The OpenVPN team has slated this option for deprecation and will be eliminated entirely in OpenVPN 2.5 and later.<\/li>\n<li><span style=\"color: #28cc57;\">Removal of the \u2013no-replay option.<\/span>\u00a0The OpenVPN team has stated that this feature is for debugging only, and should not be used outside of that context.<\/li>\n<li><span style=\"color: #28cc57;\">Removal of the \u2013reneg-bytes option.<\/span>\u00a0The OpenVPN team has stated that this will break configurations of OpenVPN that use One Time Pads, and needs to be left in for compatibility.<\/li>\n<li><span style=\"color: #28cc57;\">Increase the strength of default encryption options.<\/span>\u00a0OpenVPN 2.4 and greater has stronger defaults in that cipher negotiation is used and defaults to AES-256-GCM, while also allowing stronger future ciphers to be supported provided that both the client and server support it.<\/li>\n<li><span style=\"color: #28cc57;\">Warn about insecure modes of operation.<\/span>\u00a0OpenVPN will now issue a serious warning when \u2013cipher none or \u2013auth none is used.<\/li>\n<li><span style=\"color: #28cc57;\">Remove system() from sample authentication plugin.<\/span>\u00a0There is a commit for this fix ready for a future release, likely for 2.4.3 or 2.4.4.<\/li>\n<li><span style=\"color: #28cc57;\">Removal of \u2013script-security 3.<\/span>\u00a0The OpenVPN team disagrees with the severity of the safety risks in the recommendation. The command will remain as-is, possibly with a documentation change.<\/li>\n<li><span style=\"color: #28cc57;\">Removal of \u2013tls-verify due to non-specific vulnerability.<\/span>\u00a0The OpenVPN team failed to find any issues with the current implementation.<\/li>\n<li><span style=\"color: #28cc57;\">Warn users about compression use.<\/span>\u00a0As of 2.4.3 and higher, users will be warned about the risks of combining compression with streamed data.<\/li>\n<\/ul>\n<hr \/>\n<h4>OpenVPN is much safer after these audits, and the fixes applied to the OpenVPN mean that\u00a0the world is safer when using this software. We have verified that the OpenVPN software is generally well-written with strong adherence to security practices.<\/h4>\n<p>Please\u00a0<a href=\"https:\/\/ostif.org\/donate-to-ostif\/\"><span style=\"color: #289dcc;\">donate to OSTIF<\/span><\/a>\u00a0if you want us to continue this valuable work. We plan to continue this project indefinitely, as long as the community continues to support us. Every donation and every person you tell about OSTIF makes the Internet stronger, and safer.<\/p>\n<p>I\u2019d also like to extend a special thank you to Fred, Jean-Baptiste, Gabriel and Jordan at QuarksLab for conducting this audit, to Samuli and OpenVPN Technologies for their enthusiastic participation and the OpenVPN communities\u2019 continued development of\u00a0this crucial open-source software, and to\u00a0<a href=\"https:\/\/ostif.org\/ostif-is-beginning-a-fundraiser-for-openvpn-lets-get-it-audited\/\"><span style=\"color: #289dcc;\">the coalition of 33 companies<\/span><\/a>\u00a0and all of our individual donors for the funding to make this audit possible. We have all made the digital world a little bit safer for all of us.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>OpenVPN 2.4.0, the NDIS6 TAP Driver for Windows, the Windows GUI, and Linux versions were evaluated. This release included a number of new features including control channel encryption. QuarksLab found: 1\u00a0Critical\/High\u00a0Vulnerability\u00a0CVE-2017-7478 1\u00a0Medium\u00a0Vulnerability\u00a0CVE-2017-7479 5\u00a0Low\u00a0or\u00a0Informational\u00a0Vulnerabilities \/ Concerns This public disclosure of these vulnerabilities coincides with the release of OpenVPN 2.4.2 which fixes all of the high priority [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[69,61,68,59,60],"tags":[14,21,35],"_links":{"self":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/870"}],"collection":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/comments?post=870"}],"version-history":[{"count":19,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/870\/revisions"}],"predecessor-version":[{"id":2065,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/870\/revisions\/2065"}],"wp:attachment":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/media?parent=870"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/categories?post=870"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/tags?post=870"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}