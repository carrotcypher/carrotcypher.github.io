{"id":1449,"date":"2019-01-21T17:46:08","date_gmt":"2019-01-21T17:46:08","guid":{"rendered":"https:\/\/ostif.org\/?p=1449"},"modified":"2020-12-19T00:19:01","modified_gmt":"2020-12-19T00:19:01","slug":"the-ostif-and-quarkslab-audit-of-openssl-is-complete","status":"publish","type":"post","link":"https:\/\/ostif.org\/the-ostif-and-quarkslab-audit-of-openssl-is-complete\/","title":{"rendered":"The OSTIF and Quarkslab Audit of OpenSSL is Complete"},"content":{"rendered":"<p>We would like to thank our sponsors\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/www.privateinternetaccess.com\/\">Private Internet Access<\/a><\/span>\u00a0and\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/duckduckgo.com\/\">DuckDuckGo<\/a><\/span>\u00a0for helping to fund this security review, as well as all of our\u00a0 donors and individual supporters. This crucial work doesn\u2019t happen without support from the community.<\/p>\n<h2>The quick and dirty:<\/h2>\n<p>OpenSSL version 1.1.1 was evaluated with special foci on new TLS 1.3 features and changes made to the Pseudo Random Number Generator (PRNG). The PRNG review was conducted by Dr JP Aumasson and Antony Vennard with a follow-up review by the QuarksLab team. The general review was for all new code in OpenSSL 1.1.1 with a focus on TLS 1.3 and the changed PRNG.<\/p>\n<p>QuarksLab found a number of small issues, all of which were resolved before the public release of OpenSSL version 1.1.1. Issues one and two would have led to\u00a0<em>client-side denial-of-service vulnerabilities<\/em>, where a malicious man-in-the-middle could cause OpenSSL to crash by sending invalid information.<\/p>\n<p><strong>Issue 1:<\/strong>\u00a0In some situations a connection could fail without an alert being sent.\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/github.com\/openssl\/openssl\/pull\/6852\">https:\/\/github.com\/openssl\/openssl\/pull\/6852<\/a><\/span><\/p>\n<p><strong>Issue 2:<\/strong>\u00a0Multiple issues with TLS v1.3 alerts.\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/github.com\/openssl\/openssl\/pull\/6887\">https:\/\/github.com\/openssl\/openssl\/pull\/6887<\/a><\/span><\/p>\n<p><strong>Issue 3: New PRNG<\/strong>\u00a0\u2013 The new pseudorandom number generator in OpenSSL does follow the NIST standard implementation SP800-90A, but the code quality could improve, with better comments and more clearly defined functions. (Note: The version of the code reviewed was after the improvements made that were\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/ostif.org\/our-review-of-the-openssl-1-1-1-random-number-generation-update\/\">recommended by our other team, led by JP Aumasson<\/a><\/span>.)<\/p>\n<p><strong>Issue 4: SRP Authentication Protocol<\/strong>\u00a0\u2013 The SRP auth protocol is correctly implemented, but the code quality could improve, with better comments and more clearly defined functions. Also, SRP lacked some return value checks that would ensure that values are in an expected state. This was improved with\u00a0<a href=\"https:\/\/github.com\/openssl\/openssl\/pull\/8019\"><span style=\"color: #289dcc;\">https:\/\/github.com\/openssl\/openssl\/pull\/8019<\/span><\/a>\u00a0The specific commit is here:\u00a0<a href=\"https:\/\/github.com\/liqifyl\/openssl-image\/commit\/495a1e5c3aec4d44558cd86161b8385f1b1b6822\"><span style=\"color: #289dcc;\">https:\/\/github.com\/liqifyl\/openssl-image\/commit\/495a1e5c3aec4d44558cd86161b8385f1b1b6822<\/span><\/a><\/p>\n<p><strong>Issue 5: CAPI<\/strong>\u00a0\u2013 The code lacks comments, making the implementation hard to follow and understand. Other than these best practices issues, the code is well written and no problems were found.<\/p>\n<p><strong>Issue 6: Global Lack of NULL Checks<\/strong>\u00a0\u2013 The QuarksLab team recommended that null checks be present in many of the internal functions of OpenSSL, as a null value being passed where it is not expected by the software leads to unpredictable behavior that can lead to security or stability problems.<\/p>\n<p>The OpenSSL development team intentionally omits null checks for performance reasons, and further notes that there no known ways to pass null values in OpenSSL\u00a0<em>that lead to vulnerabilities<\/em>.<\/p>\n<p>OSTIF consulted two other security experts regarding this issue, and both agreed that while null checks can be a best practice for a defense-in-depth code strategy, it is unlikely that a vulnerability from a lack of null checks will surface unless it is portions of the code that can be called remotely.<\/p>\n<p>This is a small best practices issue that does not cause any known vulnerability or problem, and the expert opinions on the real impact differ, and the OpenSSL team did not patch.<\/p>\n<h2>Conclusion<\/h2>\n<p>OpenSSL has successfully transitioned to TLS 1.3 without any serious security problems that we\u2019ve found. The code quality and comments could stand to be improved in areas, but the code is functional, secure, and fast. The OpenSSL security team was fantastic throughout the entire process, assisting us with questions and quickly responding to concerns that were raised as we found them.<\/p>\n<p>Our work on OpenSSL has led to a total of 16 recommendations and changes in OpenSSL, and we will be adding OpenSSL to our bug bounty program for version 1.1.1a and later through our partnership with the\u00a0<a href=\"https:\/\/internetbugbounty.org\/\"><span style=\"color: #289dcc;\">Internet Bug Bounty<\/span><\/a>\u00a0on\u00a0<a href=\"https:\/\/www.hackerone.com\/\"><span style=\"color: #289dcc;\">HackerOne<\/span><\/a>.<\/p>\n<p>The full text of the report is here: (PDF Warning)\u00a0<span style=\"color: #289dcc;\"><a style=\"color: #289dcc;\" href=\"https:\/\/ostif.org\/wp-content\/uploads\/2019\/01\/18-04-720-REP_v1.2.pdf\">OpenSSL-FINAL_v1.2<\/a><\/span><\/p>\n","protected":false},"excerpt":{"rendered":"<p>We would like to thank our sponsors\u00a0Private Internet Access\u00a0and\u00a0DuckDuckGo\u00a0for helping to fund this security review, as well as all of our\u00a0 donors and individual supporters. This crucial work doesn\u2019t happen without support from the community. The quick and dirty: OpenSSL version 1.1.1 was evaluated with special foci on new TLS 1.3 features and changes made [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":2466,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[69,61,67,64],"tags":[14,51,25,3,35,18,39],"_links":{"self":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/1449"}],"collection":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/comments?post=1449"}],"version-history":[{"count":6,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/1449\/revisions"}],"predecessor-version":[{"id":1953,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/posts\/1449\/revisions\/1953"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/media\/2466"}],"wp:attachment":[{"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/media?parent=1449"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/categories?post=1449"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/ostif.org\/wp-json\/wp\/v2\/tags?post=1449"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}